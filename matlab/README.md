Utility functions for computing the embedding. Almost all of this code is taken directly from [Panozzo et al. 2013].
